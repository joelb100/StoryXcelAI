# Floating AI Assistant in Natural Position

## Problem
The floating AI needs to appear in the exact position where it would naturally be on each page, without changing layouts or AI Assistant size.

## Solution: Position-Aware Floating AI

Create a floating AI that positions itself exactly where the AI Assistant would naturally appear on each page:

```typescript
// POSITION-AWARE FLOATING AI ASSISTANT
const PositionalFloatingAI = ({ 
  activeTab,
  chatMessages, 
  chatMessage, 
  setChatMessage, 
  handleSendMessage, 
  handleKeyPress 
}: {
  activeTab: string;
  chatMessages: any[];
  chatMessage: string;
  setChatMessage: (value: string) => void;
  handleSendMessage: () => void;
  handleKeyPress: (e: React.KeyboardEvent) => void;
}) => {
  // Calculate position based on active tab
  const getPosition = () => {
    switch (activeTab) {
      case 'dashboard':
        return {
          bottom: '20px',
          left: '50%',
          transform: 'translateX(-50%)',
          width: 'min(90vw, 14.5in)',
          maxWidth: '14.5in',
          height: '280px', // Dashboard AI height
          marginRight: '280px' // Account for right sidebar
        };
      
      case 'story':
        return {
          bottom: '20px',
          left: '50%',
          transform: 'translateX(-50%)',
          width: 'min(90vw, 14.5in)',
          maxWidth: '14.5in', 
          height: '200px', // Story Builder AI height (smaller)
          marginRight: '280px' // Account for right sidebar
        };
      
      default: // All other builder pages
        return {
          bottom: '20px',
          left: '50%',
          transform: 'translateX(-50%)',
          width: 'min(90vw, 14.5in)',
          maxWidth: '14.5in',
          height: '280px', // Standard builder AI height
          marginRight: '280px' // Account for right sidebar
        };
    }
  };

  const position = getPosition();

  return (
    <div 
      id="positional-floating-ai"
      className="fixed z-40" // Lower z-index so sidebars can go over it
      style={position}
    >
      {/* AI Container - matches Dashboard styling exactly */}
      <div className="w-full h-full">
        {activeTab === 'dashboard' ? (
          // Dashboard version - with project cards
          <div className="w-full h-full flex flex-col">
            {/* Project Name Section - exactly like Dashboard */}
            <div className="mb-4">
              <div className="mb-2">
                <h3 className="text-sm font-medium text-slate-700">Project Name</h3>
              </div>
              
              {/* Three project cards - exact Dashboard styling */}
              <div className="flex gap-[0.25in]" style={{ height: '80px' }}>
                <div className="rounded-lg border-0 h-full flex-1" style={{ backgroundColor: '#3f4c5f' }}></div>
                <div className="rounded-lg border-0 h-full flex-1" style={{ backgroundColor: '#3f4c5f' }}></div>
                <div className="rounded-lg border-0 h-full flex-1" style={{ backgroundColor: '#3f4c5f' }}></div>
              </div>
            </div>

            {/* AI Assistant - Dashboard styling */}
            <div className="flex-1">
              <AIStoryAssistant 
                chatMessages={chatMessages}
                chatMessage={chatMessage}
                setChatMessage={setChatMessage}
                handleSendMessage={handleSendMessage}
                handleKeyPress={handleKeyPress}
              />
            </div>
          </div>
        ) : activeTab === 'story' ? (
          // Story Builder version - no project cards, compact
          <div className="w-full h-full">
            <AIStoryAssistant 
              chatMessages={chatMessages}
              chatMessage={chatMessage}
              setChatMessage={setChatMessage}
              handleSendMessage={handleSendMessage}
              handleKeyPress={handleKeyPress}
            />
          </div>
        ) : (
          // All other builders - with project cards
          <div className="w-full h-full flex flex-col">
            {/* Project Name Section */}
            <div className="mb-4">
              <div className="mb-2">
                <h3 className="text-sm font-medium text-slate-700">Project Name</h3>
              </div>
              
              {/* Three project cards */}
              <div className="flex gap-[0.25in]" style={{ height: '80px' }}>
                <div className="rounded-lg border-0 h-full flex-1" style={{ backgroundColor: '#3f4c5f' }}></div>
                <div className="rounded-lg border-0 h-full flex-1" style={{ backgroundColor: '#3f4c5f' }}></div>
                <div className="rounded-lg border-0 h-full flex-1" style={{ backgroundColor: '#3f4c5f' }}></div>
              </div>
            </div>

            {/* AI Assistant */}
            <div className="flex-1">
              <AIStoryAssistant 
                chatMessages={chatMessages}
                chatMessage={chatMessage}
                setChatMessage={setChatMessage}
                handleSendMessage={handleSendMessage}
                handleKeyPress={handleKeyPress}
              />
            </div>
          </div>
        )}
      </div>
    </div>
  );
};
```

## Update Main Layout - Remove AI from All Pages

Now remove the AI Assistant from all page layouts so only the floating one appears:

```typescript
{/* Dashboard - Remove AI Assistant section */}
{activeTab === 'dashboard' ? (
  <div className="bg-gray-100 flex flex-col h-full">
    <div className="bg-white border-b border-gray-200 px-4 pb-4">
      <h2 className="text-lg font-semibold text-slate-800">Dashboard</h2>
    </div>
    <div className="flex-1 flex justify-center overflow-hidden">
      <div className="w-full max-w-[15.25in] p-4 flex flex-col h-full">
        {/* Main Dashboard Section - 100% height now */}
        <div className="flex-1 flex justify-center items-center">
          <div className="rounded-lg border-0 w-full max-w-[14.5in] h-full" style={{ backgroundColor: '#3f4c5f' }}>
            {/* Main dashboard content area */}
          </div>
        </div>
        {/* NO AI ASSISTANT HERE - It's floating */}
      </div>
    </div>
  </div>

) : activeTab === 'story' ? (
  /* Story Builder - Remove AI Assistant section */
  <div className="bg-gray-100 flex flex-col h-full">
    <div className="bg-white border-b border-gray-200 px-4 pb-4">
      <h2 className="text-lg font-semibold text-slate-800">Story Builder</h2>
    </div>
    <div className="flex-1 flex justify-center overflow-hidden">
      <div className="w-full max-w-[15.25in] p-4 h-full">
        {/* Story Editor - 100% height now */}
        <div className="flex justify-center items-center h-full">
          <div className="bg-white border border-gray-200 shadow-sm rounded-lg overflow-hidden w-full max-w-[14.5in] h-full">
            <StoryBuilder 
              projectName={projectName}
              projectType={projectType}
              lengthPages={typeof lengthPages === 'number' ? lengthPages : undefined}
              lengthMinutes={typeof lengthMinutes === 'number' ? lengthMinutes : undefined}
              genre={genreLabel || undefined}
              genreDef={genreDef || undefined}
              subGenre={subGenreLabel || undefined}
              subGenreDef={subGenreDef || undefined}
              theme={themeLabel || undefined}
              themeDef={themeDef || undefined}
              subTheme={subThemeLabel || undefined}
              subThemeDef={subThemeDef || undefined}
              centralConflict={centralConflictLabel || undefined}
              centralConflictDef={centralConflictDef || undefined}
              storyHtml={storyHtml}
              setStoryHtml={setStoryHtml}
            />
          </div>
        </div>
        {/* NO AI ASSISTANT HERE - It's floating */}
      </div>
    </div>
  </div>

) : (
  /* All other builders - Remove AI Assistant sections */
  <div className="bg-gray-100 flex flex-col h-full">
    <div className="bg-white border-b border-gray-200 px-4 pb-4">
      <h2 className="text-lg font-semibold text-slate-800">
        {activeTab === 'world' && 'World Builder'}
        {activeTab === 'production' && 'Production Builder'}
        {activeTab === 'asset' && 'Asset Builder'}
        {activeTab === 'script' && 'Script Builder'}
        {activeTab === 'deck' && 'Deck Builder'}
      </h2>
    </div>
    <div className="flex-1 flex justify-center overflow-hidden">
      <div className="w-full max-w-[15.25in] p-4 flex flex-col h-full">
        {/* Builder content - 100% height now */}
        <div className="flex-1 flex justify-center items-center">
          <div className="rounded-lg border-0 w-full max-w-[14.5in] h-full" style={{ backgroundColor: '#3f4c5f' }}>
            {/* Builder content area */}
          </div>
        </div>
        {/* NO AI ASSISTANT HERE - It's floating */}
      </div>
    </div>
  </div>
)}
```

## Add Floating AI to Main Layout

Add the floating AI at the end of your main layout:

```typescript
return (
  <div className="h-screen bg-slate-800 flex flex-col overflow-hidden">
    {/* Existing header and content */}
    
    {/* POSITIONAL FLOATING AI - Appears in natural position for each page */}
    <PositionalFloatingAI 
      activeTab={activeTab}
      chatMessages={chatMessages}
      chatMessage={chatMessage}
      setChatMessage={setChatMessage}
      handleSendMessage={handleSendMessage}
      handleKeyPress={handleKeyPress}
    />
  </div>
);
```

## Result:

- ✅ **Dashboard**: AI appears exactly where it naturally would, with project cards
- ✅ **Story Builder**: AI appears exactly where it naturally would, without project cards, smaller size
- ✅ **Other Builders**: AI appears exactly where it naturally would, with project cards
- ✅ **Same component**: Literally the same AI Assistant on every page
- ✅ **Natural positioning**: Doesn't interfere with layouts
- ✅ **Responsive sizing**: Adapts size based on page needs

This gives you a truly universal AI Assistant that appears in the natural position for each page type!