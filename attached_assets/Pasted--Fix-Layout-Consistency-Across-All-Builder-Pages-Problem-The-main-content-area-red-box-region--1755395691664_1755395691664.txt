# Fix Layout Consistency Across All Builder Pages

## Problem
The main content area (red box region) in my StoryXcel dashboard has inconsistent positioning across different pages (World, Production, Asset, Story, Script, Deck). I need the layout within the main content area to be identical on all pages.

## Current File Structure
- `client/src/pages/dashboard-layout.tsx` - Main layout component that handles all builder pages
- Currently around line 1400, different tabs have different layout structures
- Story tab has custom grid layout, other tabs have basic structure

## Required Changes

### 1. Create Shared Layout Component
Add this new component to `dashboard-layout.tsx` (place it before the main export):

```typescript
// Shared Main Content Layout Component - Ensures consistent positioning
const SharedMainContentLayout = ({ 
  children, 
  pageTitle, 
  activeTab,
  chatMessages,
  chatMessage,
  setChatMessage,
  handleSendMessage,
  handleKeyPress
}: { 
  children: React.ReactNode; 
  pageTitle: string; 
  activeTab: string;
  chatMessages: any[];
  chatMessage: string;
  setChatMessage: (value: string) => void;
  handleSendMessage: () => void;
  handleKeyPress: (e: React.KeyboardEvent) => void;
}) => (
  <div className="bg-gray-100 flex flex-col h-full">
    {/* Consistent Header across all pages */}
    <div className="bg-white border-b border-gray-200 px-4 pb-4">
      <h2 className="text-lg font-semibold text-slate-800">{pageTitle}</h2>
    </div>

    {/* Constrained Content Container - IDENTICAL positioning for all pages */}
    <div className="flex-1 flex justify-center overflow-hidden">
      <div className="w-full max-w-[15.25in] p-4 flex flex-col h-full">
        
        {/* RED BOX AREA - Main Content Section - CONSISTENT 70.8% height */}
        <div className="flex justify-center items-center" style={{ height: '70.8%' }}>
          <div className="rounded-lg border-0 w-full max-w-[14.5in] h-full" style={{ backgroundColor: '#3f4c5f' }}>
            {/* This is where page-specific content goes */}
            {children}
          </div>
        </div>

        {/* Bottom section - CONSISTENT 29.2% height for all pages */}
        <div className="flex flex-col justify-start pt-4" style={{ height: '29.2%' }}>
          {/* Project Name Section - only show for non-dashboard pages */}
          {activeTab !== 'dashboard' && (
            <div className="flex justify-center mb-4">
              <div className="w-full max-w-[14.5in]">
                <div className="mb-2">
                  <h3 className="text-sm font-medium text-slate-700">Project Name</h3>
                </div>
                
                {/* Three equal project cards - IDENTICAL spacing for all pages */}
                <div className="flex gap-[0.25in]" style={{ height: '25%', minHeight: '80px' }}>
                  <div className="rounded-lg border-0 h-full flex-1" style={{ backgroundColor: '#3f4c5f' }}></div>
                  <div className="rounded-lg border-0 h-full flex-1" style={{ backgroundColor: '#3f4c5f' }}></div>
                  <div className="rounded-lg border-0 h-full flex-1" style={{ backgroundColor: '#3f4c5f' }}></div>
                </div>
              </div>
            </div>
          )}

          {/* AI Chat Window - IDENTICAL for all pages */}
          <div className="flex-1">
            <AIStoryAssistant 
              chatMessages={chatMessages}
              chatMessage={chatMessage}
              setChatMessage={setChatMessage}
              handleSendMessage={handleSendMessage}
              handleKeyPress={handleKeyPress}
            />
          </div>
        </div>
      </div>
    </div>
  </div>
);
```

### 2. Replace Main Content Rendering
Find the main content area rendering (around line 1400) that starts with:
```typescript
{/* Main Content - Dashboard fixed, Story tab dynamic, other tabs static */}
<div className={`transition-all duration-300 ${
  activeTab === 'dashboard' 
    ? 'col-span-19' 
    : activeTab === 'story'
```

Replace the entire content div with:

```typescript
{/* Main Content - CONSISTENT layout for all pages */}
<div className={`transition-all duration-300 ${
  activeTab === 'dashboard' 
    ? 'col-span-19' 
    : activeTab === 'story'
      ? (isFriendsListOpen || isSiteLinksOpen ? 'col-span-19' : 'col-span-22')
      : 'col-span-22'
}`}>
  {activeTab === 'dashboard' ? (
    <DashboardContent 
      chatMessages={chatMessages}
      chatMessage={chatMessage}
      setChatMessage={setChatMessage}
      handleSendMessage={handleSendMessage}
      handleKeyPress={handleKeyPress}
      currentProjectSlide={currentProjectSlide}
      setCurrentProjectSlide={setCurrentProjectSlide}
      navigate={navigate}
    />
  ) : activeTab === 'story' ? (
    <SharedMainContentLayout 
      pageTitle="Story Builder" 
      activeTab={activeTab}
      chatMessages={chatMessages}
      chatMessage={chatMessage}
      setChatMessage={setChatMessage}
      handleSendMessage={handleSendMessage}
      handleKeyPress={handleKeyPress}
    >
      {/* Story-specific content goes in the red box area */}
      <StoryBuilder 
        projectName={projectName}
        projectType={projectType}
        lengthPages={typeof lengthPages === 'number' ? lengthPages : undefined}
        lengthMinutes={typeof lengthMinutes === 'number' ? lengthMinutes : undefined}
        genre={genreLabel || undefined}
        genreDef={genreDef || undefined}
        subGenre={subGenreLabel || undefined}
        subGenreDef={subGenreDef || undefined}
        theme={themeLabel || undefined}
        themeDef={themeDef || undefined}
        subTheme={subThemeLabel || undefined}
        subThemeDef={subThemeDef || undefined}
        centralConflict={centralConflictLabel || undefined}
        centralConflictDef={centralConflictDef || undefined}
        storyHtml={storyHtml}
        setStoryHtml={setStoryHtml}
      />
    </SharedMainContentLayout>
  ) : (
    // All other builder tabs use the SAME layout structure
    <SharedMainContentLayout 
      pageTitle={
        activeTab === 'world' ? 'World Builder' :
        activeTab === 'production' ? 'Production Builder' :
        activeTab === 'asset' ? 'Asset Builder' :
        activeTab === 'script' ? 'Script Builder' :
        activeTab === 'deck' ? 'Deck Builder' :
        'Builder'
      }
      activeTab={activeTab}
      chatMessages={chatMessages}
      chatMessage={chatMessage}
      setChatMessage={setChatMessage}
      handleSendMessage={handleSendMessage}
      handleKeyPress={handleKeyPress}
    >
      {/* Page-specific content goes here - same positioning for all */}
      {activeTab === 'world' && (
        <div className="w-full h-full p-4 text-white">
          <h3 className="text-lg mb-4">World Builder Content</h3>
          {/* Add your world builder components here */}
        </div>
      )}
      
      {activeTab === 'production' && (
        <div className="w-full h-full p-4 text-white">
          <h3 className="text-lg mb-4">Production Builder Content</h3>
          {/* Add your production builder components here */}
        </div>
      )}
      
      {activeTab === 'asset' && (
        <div className="w-full h-full p-4 text-white">
          <h3 className="text-lg mb-4">Asset Builder Content</h3>
          {/* Add your asset builder components here */}
        </div>
      )}
      
      {activeTab === 'script' && (
        <div className="w-full h-full p-4 text-white">
          <h3 className="text-lg mb-4">Script Builder Content</h3>
          {/* Add your script builder components here */}
        </div>
      )}
      
      {activeTab === 'deck' && (
        <div className="w-full h-full p-4 text-white">
          <h3 className="text-lg mb-4">Deck Builder Content</h3>
          {/* Add your deck builder components here */}
        </div>
      )}
    </SharedMainContentLayout>
  )}
</div>
```

## Expected Result
After these changes:
- ✅ Red box area (main content) will be positioned identically on World, Production, Asset, Story, Script, and Deck pages
- ✅ Project cards below will have identical spacing and positioning
- ✅ AI chat area will be consistent across all pages
- ✅ Dashboard page remains unchanged with its unique layout
- ✅ Story page keeps its StoryBuilder content but with consistent positioning

## Files to Modify
- `client/src/pages/dashboard-layout.tsx` - Add SharedMainContentLayout component and replace main content rendering

The layout within the red box region will now be uniform across all builder pages while allowing each page to have its own specific content.